(window.webpackJsonp=window.webpackJsonp||[]).push([[31],{597:function(s,a,t){s.exports=t.p+"assets/img/20221031095751.86ca0bc9.png"},656:function(s,a,t){"use strict";t.r(a);var e=t(7),n=Object(e.a)({},(function(){var s=this,a=s.$createElement,e=s._self._c||a;return e("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[e("h2",{attrs:{id:"minikube"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#minikube"}},[s._v("#")]),s._v(" minikube")]),s._v(" "),e("p",[e("a",{attrs:{href:"https://minikube.sigs.k8s.io/docs/start/",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://minikube.sigs.k8s.io/docs/start/"),e("OutboundLink")],1)]),s._v(" "),e("h3",{attrs:{id:"installation"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#installation"}},[s._v("#")]),s._v(" Installation")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("curl")]),s._v(" -LO https://storage.googleapis.com/minikube/releases/latest/minikube-latest.x86_64.rpm\n"),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("rpm")]),s._v(" -Uvh minikube-latest.x86_64.rpm\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br")])]),e("h3",{attrs:{id:"start-your-cluster"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#start-your-cluster"}},[s._v("#")]),s._v(" Start your cluster")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("useradd")]),s._v(" k8s\n"),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("usermod")]),s._v(" -a -G docker k8s\n"),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("passwd")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("su")]),s._v(" - k8s\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 启动集群")]),s._v("\nminikube start\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 启动集群")]),s._v("\nminikube start "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n--driver"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("docker "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n--kubernetes-version"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("v1.23.8 "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n--image-mirror-country"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'cn'")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n--image-repository"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'registry.cn-hangzhou.aliyuncs.com/google_containers'")]),s._v("\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#  停止集群")]),s._v("\nminikube stop\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 获取集群状态")]),s._v("\nminikube status\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 删除集群")]),s._v("\nminikube delete\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看集群IP")]),s._v("\nminikube "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("ip")]),s._v("\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看集群日志")]),s._v("\nminikube logs\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 打印minikube版本信息")]),s._v("\nminikube version\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br"),e("span",{staticClass:"line-number"},[s._v("18")]),e("br"),e("span",{staticClass:"line-number"},[s._v("19")]),e("br"),e("span",{staticClass:"line-number"},[s._v("20")]),e("br"),e("span",{staticClass:"line-number"},[s._v("21")]),e("br"),e("span",{staticClass:"line-number"},[s._v("22")]),e("br"),e("span",{staticClass:"line-number"},[s._v("23")]),e("br"),e("span",{staticClass:"line-number"},[s._v("24")]),e("br"),e("span",{staticClass:"line-number"},[s._v("25")]),e("br"),e("span",{staticClass:"line-number"},[s._v("26")]),e("br"),e("span",{staticClass:"line-number"},[s._v("27")]),e("br"),e("span",{staticClass:"line-number"},[s._v("28")]),e("br"),e("span",{staticClass:"line-number"},[s._v("29")]),e("br"),e("span",{staticClass:"line-number"},[s._v("30")]),e("br"),e("span",{staticClass:"line-number"},[s._v("31")]),e("br")])]),e("h3",{attrs:{id:"interact-with-your-cluster"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#interact-with-your-cluster"}},[s._v("#")]),s._v(" Interact with your cluster")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[s._v("minikube kubectl -- get pods -A\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# 修改.bashrc，添加 alias kubectl="minikube kubectl --"')]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("vim")]),s._v(" .bashrc\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 刷新.bashrc")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("source")]),s._v(" .bashrc\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 可以使用 kubectl 代替 minikube kubectl")]),s._v("\nkubectl get po -A\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br")])]),e("h3",{attrs:{id:"deploy-applications"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#deploy-applications"}},[s._v("#")]),s._v(" Deploy applications")]),s._v(" "),e("p",[s._v("Create a sample deployment and expose it on port 80:")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[s._v("kubectl create deployment hello-minikube --image"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("docker.io/nginx:1.23\nkubectl expose deployment hello-minikube --type"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("NodePort --port"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br")])]),e("p",[s._v("It may take a moment, but your deployment will soon show up when you run:")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("k8s@k8s ~"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("$ minikube "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("service")]),s._v(" hello-minikube\n"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("-----------"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("----------------"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("-------------"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("---------------------------"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" NAMESPACE "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("      NAME      "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" TARGET PORT "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("            URL            "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("-----------"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("----------------"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("-------------"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("---------------------------"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" default   "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" hello-minikube "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("          "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" http://192.168.49.2:30831 "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("-----------"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("----------------"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("-------------"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("---------------------------"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n🎉  Opening "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("service")]),s._v(" default/hello-minikube "),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" default browser"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(".\n👉  http://192.168.49.2:30831\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br")])]),e("p",[s._v("The easiest way to access this service is to let minikube launch a web browser for you:")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("k8s@k8s ~"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("$ minikube "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("service")]),s._v(" hello-minikube\n"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("-----------"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("----------------"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("-------------"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("---------------------------"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" NAMESPACE "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("      NAME      "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" TARGET PORT "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("            URL            "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("-----------"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("----------------"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("-------------"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("---------------------------"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" default   "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" hello-minikube "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("          "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" http://192.168.49.2:30831 "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("-----------"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("----------------"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("-------------"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("---------------------------"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n🎉  Opening "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("service")]),s._v(" default/hello-minikube "),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" default browser"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(".\n👉  http://192.168.49.2:30831\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br")])]),e("p",[s._v("Alternatively, use kubectl to forward the port:")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[s._v("kubectl port-forward service/hello-minikube --address "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v(".0.0 "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("8080")]),s._v(":80\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("Tada! Your application is now available at http://localhost:8080/.")]),s._v(" "),e("h2",{attrs:{id:"dashboard"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#dashboard"}},[s._v("#")]),s._v(" Dashboard")]),s._v(" "),e("p",[e("a",{attrs:{href:"https://kubernetes.io/zh-cn/docs/tasks/access-application-cluster/web-ui-dashboard/",target:"_blank",rel:"noopener noreferrer"}},[s._v("部署和访问 Kubernetes 仪表板（Dashboard）"),e("OutboundLink")],1)]),s._v(" "),e("p",[s._v("1、默认情况下不会部署 Dashboard。可以通过以下命令部署：")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[s._v("kubectl apply -f https://raw.githubusercontent.com/kubernetes/dashboard/v2.6.1/aio/deploy/recommended.yaml\n\n"),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" /home/k8s\n"),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("wget")]),s._v(" https://raw.githubusercontent.com/kubernetes/dashboard/v2.6.1/aio/deploy/recommended.yaml\n"),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("mv")]),s._v(" recommended.yaml kubernetes-dashboard-v2.6.1.yaml\nkubectl apply -f /home/k8s/kubernetes-dashboard-v2.6.1.yaml\n\nkubectl delete -f /home/k8s/kubernetes-dashboard-v2.6.1.yaml\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br")])]),e("p",[s._v("2、为 Dashboard 添加外网访问：")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[s._v("kubectl port-forward -n kubernetes-dashboard --address "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v(".0.0 service/kubernetes-dashboard "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("8001")]),s._v(":443\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("访问 https://192.168.1.26:8001/ 即可")]),s._v(" "),e("p",[s._v("3、获取需要登录的token")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[s._v("kubectl get secret "),e("span",{pre:!0,attrs:{class:"token variable"}},[e("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$(")]),s._v("kubectl get serviceaccount dashboard -o "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("jsonpath")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"{.secrets[0].name}"')]),e("span",{pre:!0,attrs:{class:"token variable"}},[s._v(")")])]),s._v(" -o "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("jsonpath")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"{.data.token}"')]),s._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" base64 --decode\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("eyJhbGciOiJSUzI1NiIsImtpZCI6Im1WQTY2Nng2M1JFR0cxdjJoclJHZXhpOTA2Qjhxd3RpTktpaGpjR1pfU00ifQ.eyJpc3MiOiJrdWJlcm5ldGVzL3NlcnZpY2VhY2NvdW50Iiwia3ViZXJuZXRlcy5pby9zZXJ2aWNlYWNjb3VudC9uYW1lc3BhY2UiOiJkZWZhdWx0Iiwia3ViZXJuZXRlcy5pby9zZXJ2aWNlYWNjb3VudC9zZWNyZXQubmFtZSI6ImRhc2hib2FyZC10b2tlbi13c3dudCIsImt1YmVybmV0ZXMuaW8vc2VydmljZWFjY291bnQvc2VydmljZS1hY2NvdW50Lm5hbWUiOiJkYXNoYm9hcmQiLCJrdWJlcm5ldGVzLmlvL3NlcnZpY2VhY2NvdW50L3NlcnZpY2UtYWNjb3VudC51aWQiOiI5OTM4MGMwMS1jMTU3LTQzZDAtODQwOC0yODBlNWMyNTk3Y2IiLCJzdWIiOiJzeXN0ZW06c2VydmljZWFjY291bnQ6ZGVmYXVsdDpkYXNoYm9hcmQifQ.EBuH2NMe0TN2lUF55laW7RFjltQ5_I4vZl1t3zQNpScayfm2AbuyTVj-LnukX1OhMch7v4ZwYqlCBdGIzOv6FH_EF8DxigteCOxAV-5KTP3tZgGgVZE3spdV4aQJ0mgbqfVpQyXf2pfH_8aXZWyZt-dCo75pD4RdYaR4YizHqWT0_6AS75PAzDnRvE5W7S7Pk2YWAVo0qerrfVkeSXvJ1KolVCp9ajeCUl-4z0P-b7f5-7Uz9J5amty2AasLCgvkOXf_1uG09IxVLNsShH0EdPbzv01TG8D4aruj3KxdFP8jYmWgFrn-FNC8w1Tb0ySUX40iwV7pCxTcXkVNHW5Vlg\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("如果没有token，那就创建一个")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[s._v("kubectl create serviceaccount dashboard -n default\nkubectl create clusterrolebinding dashboard-admin -n default --clusterrole"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("cluster-admin  --serviceaccount"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("default:dashboard\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br")])]),e("p",[s._v("error: listen tcp 127.0.0.1:8001: bind: address already in use")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 找到被占用的端口，以8001为例")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("k8s@k8s ~"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("$ "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("netstat")]),s._v(" -tulpn "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("grep")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("8001")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("Not all processes could be identified, non-owned process info\n will not be shown, you would have to be root to see it all."),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\ntcp6       "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("      "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" :::8001                 :::*                    LISTEN      "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("9471")]),s._v("/kubectl\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 释放对应的端口，9471为对应的PID")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("kill")]),s._v(" -9 "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("9471")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br")])]),e("h2",{attrs:{id:"核心概念及操作"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#核心概念及操作"}},[s._v("#")]),s._v(" 核心概念及操作")]),s._v(" "),e("p",[e("a",{attrs:{href:"https://kubernetes.io/docs/home/",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://kubernetes.io/docs/home/"),e("OutboundLink")],1)]),s._v(" "),e("p",[s._v("资源创建方式有两种：")]),s._v(" "),e("ul",[e("li",[s._v("命令行")]),s._v(" "),e("li",[s._v("YAML")])]),s._v(" "),e("h3",{attrs:{id:"kubectl"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#kubectl"}},[s._v("#")]),s._v(" kubectl")]),s._v(" "),e("p",[s._v("kubectl 命令行的语法格式如下：")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[s._v("kubectl --help\nkubectl "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("command"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("TYPE"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("NAME"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("flags"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br")])]),e("ul",[e("li",[e("p",[s._v("command：子命令，用于操作 k8s 集群资源对象的命令，例如 create、get、describe、delete。")]),s._v(" "),e("p",[s._v("更多命令见："),e("a",{attrs:{href:"https://kubernetes.io/docs/reference/generated/kubectl/kubectl-commands",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://kubernetes.io/docs/reference/generated/kubectl/kubectl-commands"),e("OutboundLink")],1)])]),s._v(" "),e("li",[e("p",[s._v("TYPE：k8s 集群中资源对象的类型，区分大小写，能以单数、复数或者简写形式表示")]),s._v(" "),e("ul",[e("li",[e("p",[s._v("pod（po）")])]),s._v(" "),e("li",[e("p",[s._v("service（svc）")])]),s._v(" "),e("li",[e("p",[s._v("replication controller（rc）")])]),s._v(" "),e("li",[e("p",[s._v("deployment（deploy）")])]),s._v(" "),e("li",[e("p",[s._v("replica set（rs）")])])])])]),s._v(" "),e("img",{attrs:{src:t(597)}}),s._v(" "),e("ul",[e("li",[e("p",[s._v("NAME：k8s 集群中资源对象的名称，区分大小写。如果不指定名称，系统则返回属于 TYPE 的全部资源对象列表")])]),s._v(" "),e("li",[e("p",[s._v("flags：kubectl 子命令的可选参数")]),s._v(" "),e("p",[s._v("kubectl 每个子命令（如 create、get、describe、delete 等）还有特定的 flags 参数，可以通过")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[s._v("kubectl "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("command"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" --help\nkubectl "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("command"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("TYPE"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" --help\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br")])]),e("p",[s._v("命令查看。")])])]),s._v(" "),e("h3",{attrs:{id:"namespace"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#namespace"}},[s._v("#")]),s._v(" Namespace")]),s._v(" "),e("p",[s._v("Namespace 默认只隔离资源，不隔离网络。语法格式：")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[s._v("kubectl "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("command"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" ns "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("NAME"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("flags"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\nkubectl "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("command"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" ns --help\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br")])]),e("p",[s._v("示例：")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[s._v("kubectl get ns\nkubectl create ns dev\nkubectl delete ns dev\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看已存在命名空间的yaml配置")]),s._v("\nkubectl get ns dev -o"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("yaml\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 导出已存在命名空间的yaml配置")]),s._v("\nkubectl get ns dev -o"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("yaml "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" dev-namespace.yaml\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 导出不存在命名空间的yaml配置")]),s._v("\nkubectl create ns "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("test")]),s._v(" -o"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("yaml --dry-run"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("client "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" test-namespace.yaml\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br")])]),e("h3",{attrs:{id:"pod"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#pod"}},[s._v("#")]),s._v(" Pod")]),s._v(" "),e("p",[s._v("Pod 运行中的一组容器，Pod是kubernetes的最小单位。")]),s._v(" "),e("p",[s._v("语法格式：")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[s._v("kubectl "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("command"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" pod "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("NAME"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("flags"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\nkubectl "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("command"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" pod --help\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br")])]),e("p",[s._v("示例：")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看所有命名空间的pod")]),s._v("\nkubectl get pod -A\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看默认名称空间下的pod")]),s._v("\nkubectl get pod\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看默认名称空间下的pod（显示更加详细的信息）")]),s._v("\nkubectl get pod -owide\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 监听pod的变化")]),s._v("\nkubectl get pod -w\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Create and run a particular image in a pod.")]),s._v("\nkubectl run my-nginx --image"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("docker.io/nginx:1.23 --port"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),s._v("\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Show details of a specific resource or group of resources.")]),s._v("\nkubectl describe pod my-nginx\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Print the logs for a container in a pod or specified resource. If the pod has only one container, the container name is optional.")]),s._v("\nkubectl logs my-nginx\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Execute a command in a container.")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# kubectl exec (POD | TYPE/NAME) [-c CONTAINER] [flags] -- COMMAND [args...]")]),s._v("\nkubectl "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exec")]),s._v(" -it my-nginx -- /bin/bash\n\nkubectl delete pod my-nginx\nkubectl delete -n default pod my-nginx\n\nkubectl get pod my-nginx -o"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("yaml\nkubectl get pod my-nginx -o"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("yaml "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" my-nginx-pod.yaml\nkubectl run my-nginx --image"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("docker.io/nginx:1.23 --port"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),s._v(" -o"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("yaml --dry-run"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("client "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" my-nginx-pod.yaml\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br"),e("span",{staticClass:"line-number"},[s._v("18")]),e("br"),e("span",{staticClass:"line-number"},[s._v("19")]),e("br"),e("span",{staticClass:"line-number"},[s._v("20")]),e("br"),e("span",{staticClass:"line-number"},[s._v("21")]),e("br"),e("span",{staticClass:"line-number"},[s._v("22")]),e("br"),e("span",{staticClass:"line-number"},[s._v("23")]),e("br"),e("span",{staticClass:"line-number"},[s._v("24")]),e("br"),e("span",{staticClass:"line-number"},[s._v("25")]),e("br"),e("span",{staticClass:"line-number"},[s._v("26")]),e("br"),e("span",{staticClass:"line-number"},[s._v("27")]),e("br"),e("span",{staticClass:"line-number"},[s._v("28")]),e("br")])]),e("h3",{attrs:{id:"deployment"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#deployment"}},[s._v("#")]),s._v(" Deployment")]),s._v(" "),e("p",[s._v("Deployment 控制 Pod，使Pod拥有多个副本，自愈、扩容等功能。")]),s._v(" "),e("p",[s._v("语法格式：")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[s._v("kubectl "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("command"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" deploy "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("NAME"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("flags"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\nkubectl "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("command"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" deploy --help\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br")])]),e("p",[s._v("示例：")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[s._v("kubectl get deployment\n\nkubectl create deployment my-nginx --image"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("docker.io/nginx:1.23\nkubectl create deployment my-nginx --image"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("docker.io/nginx:1.23 --replicas"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v("\n\nkubectl expose deployment my-nginx --type"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("NodePort --port"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),s._v("\n\nkubectl edit deployment my-nginx\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 扩容")]),s._v("\nkubectl scale --current-replicas"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v(" --replicas"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v(" deployment/my-nginx\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 缩容")]),s._v("\nkubectl scale --current-replicas"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v(" --replicas"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" deployment/my-nginx\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 滚动更新/不停机维护")]),s._v("\nkubectl "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("set")]),s._v(" image deployment/my-nginx "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("nginx")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("nginx:1.9.1 --record\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看历史记录")]),s._v("\nkubectl rollout "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("history")]),s._v(" deployment/my-nginx\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 版本回退")]),s._v("\nkubectl rollout undo deployment/my-nginx --to-revision"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n\nkubectl delete deployment my-nginx\nkubectl delete -n default deployment my-nginx\n\nkubectl get deployment my-nginx -o"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("yaml\nkubectl get deployment my-nginx -o"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("yaml "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" deployment.yaml\nkubectl create deployment my-nginx --image"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("docker.io/nginx:1.23 --replicas"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v(" -o"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("yaml --dry-run"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("client "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" deployment.yaml\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br"),e("span",{staticClass:"line-number"},[s._v("18")]),e("br"),e("span",{staticClass:"line-number"},[s._v("19")]),e("br"),e("span",{staticClass:"line-number"},[s._v("20")]),e("br"),e("span",{staticClass:"line-number"},[s._v("21")]),e("br"),e("span",{staticClass:"line-number"},[s._v("22")]),e("br"),e("span",{staticClass:"line-number"},[s._v("23")]),e("br"),e("span",{staticClass:"line-number"},[s._v("24")]),e("br"),e("span",{staticClass:"line-number"},[s._v("25")]),e("br"),e("span",{staticClass:"line-number"},[s._v("26")]),e("br")])]),e("h3",{attrs:{id:"service"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#service"}},[s._v("#")]),s._v(" Service")]),s._v(" "),e("p",[s._v("Service ，将一组Pods公开为网络服务的抽象方法，Pod的服务发现和负载均衡。")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Expose a resource as a new Kubernetes service.")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# type: Type for this service: ClusterIP, NodePort, LoadBalancer, or ExternalName. Default is 'ClusterIP'.")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# --type=ClusterIP: 仅仅集群内访问")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# --type=NodePort: 集群外可以访问")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# --port: The port that the service should serve on.")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# --target-port: Name or number for the port on the container that the service should direct traffic to")]),s._v("\nkubectl expose pod my-pod-1 --port"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("10080")]),s._v(" --target-port"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),s._v(" --type"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("NodePort\nkubectl expose pod my-nginx --port"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("10080")]),s._v(" --target-port"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),s._v(" --type"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("NodePort -o"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("yaml --dry-run"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("client "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" service.yaml\n\nkubectl get "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("service")]),s._v("\nkubectl get svc\nkubectl delete svc my-nginx\nkubectl delete -n default "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("service")]),s._v(" my-nginx\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br")])]),e("h3",{attrs:{id:"yaml"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#yaml"}},[s._v("#")]),s._v(" YAML")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[s._v("kubectl apply -f xxx.yaml\nkubectl delete -f xxx.yaml\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br")])]),e("h2",{attrs:{id:"q-a"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#q-a"}},[s._v("#")]),s._v(" Q&A")]),s._v(" "),e("h3",{attrs:{id:"clusterip和nodeport"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#clusterip和nodeport"}},[s._v("#")]),s._v(" ClusterIP和NodePort")]),s._v(" "),e("p",[s._v("ClusterIP，仅允许集群内访问")]),s._v(" "),e("p",[s._v("NodePort，在集群外可以访问，The range of valid ports is 30000-32767")]),s._v(" "),e("h3",{attrs:{id:"targetport、port、nodeport"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#targetport、port、nodeport"}},[s._v("#")]),s._v(" targetPort、port、nodePort")]),s._v(" "),e("p",[s._v("同一个pod中，不同container之间可以互相访问")]),s._v(" "),e("div",{staticClass:"language-yaml line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-yaml"}},[e("code",[e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("apiVersion")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" v1\n"),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("kind")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" Pod\n"),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("metadata")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("name")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" my"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("pod\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("namespace")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" default\n"),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("spec")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("containers")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("image")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" docker.io/nginx"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.23")]),s._v("\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("name")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" my"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("nginx\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("ports")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("containerPort")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),s._v("  "),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 与Service的targetPort值一致")]),s._v("\n  "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("image")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" tomcat\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("name")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" my"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("tomcat\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("ports")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("containerPort")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("8080")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 与Service的targetPort值一致")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br")])]),e("div",{staticClass:"language-yaml line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-yaml"}},[e("code",[e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("apiVersion")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" v1\n"),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("kind")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" Service\n"),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("metadata")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("labels")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("run")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" my"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("nginx\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("name")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" my"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("nginx\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("namespace")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" default\n"),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("spec")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("ports")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("port")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("10080")]),s._v("     "),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# service暴露出来的port，在其他pod内可以通过serviceIp:port或者serviceName.namespace.svc:port访问，用于集群内访问")]),s._v("\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("protocol")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" TCP\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("targetPort")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),s._v("  "),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# container暴露出来的port，同一个pod中，不同container之间可以互相访问")]),s._v("\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("nodePort")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("30080")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 与type: NodePort一起使用")]),s._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("type")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" NodePort    "),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# type设置为NodePort，就可以让外网访问了")]),s._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("selector")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("run")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" my"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("nginx   "),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 通过selector来寻找相同label的pod")]),s._v("\n    \n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("---")]),s._v("\n\n"),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("apiVersion")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" v1\n"),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("kind")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" Service\n"),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("metadata")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("labels")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("run")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" my"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("pod\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("name")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" my"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("pod\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("namespace")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" default\n"),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("spec")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("ports")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("port")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("10080")]),s._v("     "),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# service暴露出来的port，在其他pod内可以通过serviceIp:port或者serviceName.namespace.svc:port访问，用于集群内访问")]),s._v("\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("protocol")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" TCP\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("targetPort")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),s._v("  "),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# container暴露出来的port，同一个pod中，不同container之间可以互相访问")]),s._v("\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("nodePort")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("30081")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 与type: NodePort一起使用")]),s._v("\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("name")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" my"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("nginx\n  "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("port")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("18080")]),s._v("     "),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# service暴露出来的port，在其他pod内可以通过serviceIp:port或者serviceName.namespace.svc:port访问，用于集群内访问")]),s._v("\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("protocol")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" TCP\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("targetPort")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("8080")]),s._v("  "),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# container暴露出来的port，同一个pod中，不同container之间可以互相访问")]),s._v("\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("nodePort")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("30082")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 与type: NodePort一起使用 ")]),s._v("\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("name")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" my"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("tomcat\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("type")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" NodePort    "),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# type设置为NodePort，就可以让外网访问了")]),s._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("selector")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("name")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" my"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("pod   "),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 通过selector来寻找相同label的pod")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br"),e("span",{staticClass:"line-number"},[s._v("18")]),e("br"),e("span",{staticClass:"line-number"},[s._v("19")]),e("br"),e("span",{staticClass:"line-number"},[s._v("20")]),e("br"),e("span",{staticClass:"line-number"},[s._v("21")]),e("br"),e("span",{staticClass:"line-number"},[s._v("22")]),e("br"),e("span",{staticClass:"line-number"},[s._v("23")]),e("br"),e("span",{staticClass:"line-number"},[s._v("24")]),e("br"),e("span",{staticClass:"line-number"},[s._v("25")]),e("br"),e("span",{staticClass:"line-number"},[s._v("26")]),e("br"),e("span",{staticClass:"line-number"},[s._v("27")]),e("br"),e("span",{staticClass:"line-number"},[s._v("28")]),e("br"),e("span",{staticClass:"line-number"},[s._v("29")]),e("br"),e("span",{staticClass:"line-number"},[s._v("30")]),e("br"),e("span",{staticClass:"line-number"},[s._v("31")]),e("br"),e("span",{staticClass:"line-number"},[s._v("32")]),e("br"),e("span",{staticClass:"line-number"},[s._v("33")]),e("br"),e("span",{staticClass:"line-number"},[s._v("34")]),e("br"),e("span",{staticClass:"line-number"},[s._v("35")]),e("br"),e("span",{staticClass:"line-number"},[s._v("36")]),e("br"),e("span",{staticClass:"line-number"},[s._v("37")]),e("br"),e("span",{staticClass:"line-number"},[s._v("38")]),e("br"),e("span",{staticClass:"line-number"},[s._v("39")]),e("br"),e("span",{staticClass:"line-number"},[s._v("40")]),e("br"),e("span",{staticClass:"line-number"},[s._v("41")]),e("br")])]),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 集群内访问")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("curl")]),s._v(" my-nginx.default.svc:10080\n"),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("curl")]),s._v(" my-pod.default.svc:10080\n"),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("curl")]),s._v(" my-pod.default.svc:18080\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 集群外访问（在Centos7中）")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("k8s@k8s ~"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("$ minikube "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("ip")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".49.2\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("k8s@k8s ~"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("$ "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("curl")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".49.2:30080\n"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v("DOCTYPE html"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("html"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("head"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("title"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("Welcome to nginx"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("/title"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("style"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\nhtml "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" color-scheme: light dark"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\nbody "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" width: 35em"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" margin: "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" auto"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\nfont-family: Tahoma, Verdana, Arial, sans-serif"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("/style"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("/head"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("body"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("h"),e("span",{pre:!0,attrs:{class:"token operator"}},[e("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[s._v("1")]),s._v(">")]),s._v("Welcome to nginx"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("/h"),e("span",{pre:!0,attrs:{class:"token operator"}},[e("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[s._v("1")]),s._v(">")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("p"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("If you see this page, the nginx web server is successfully installed and\nworking. Further configuration is required."),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("/p"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n\n"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("p"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("For online documentation and support please refer to\n"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("a "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("href")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"http://nginx.org/"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("nginx.org"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("/a"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("."),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("br/"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\nCommercial support is available at\n"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("a "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("href")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"http://nginx.com/"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("nginx.com"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("/a"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("."),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("/p"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n\n"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("p"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("em"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("Thank you "),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" using nginx."),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("/em"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("/p"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("/body"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("/html"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 集群外访问（在宿主机中）")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 先暴露端口，然后在浏览器中访问 http://192.168.1.26:30080/ 即可，按Ctrl+C结束端口暴露")]),s._v("\nkubectl port-forward --address "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v(".0.0 service/my-nginx "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("30080")]),s._v(":10080\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br"),e("span",{staticClass:"line-number"},[s._v("18")]),e("br"),e("span",{staticClass:"line-number"},[s._v("19")]),e("br"),e("span",{staticClass:"line-number"},[s._v("20")]),e("br"),e("span",{staticClass:"line-number"},[s._v("21")]),e("br"),e("span",{staticClass:"line-number"},[s._v("22")]),e("br"),e("span",{staticClass:"line-number"},[s._v("23")]),e("br"),e("span",{staticClass:"line-number"},[s._v("24")]),e("br"),e("span",{staticClass:"line-number"},[s._v("25")]),e("br"),e("span",{staticClass:"line-number"},[s._v("26")]),e("br"),e("span",{staticClass:"line-number"},[s._v("27")]),e("br"),e("span",{staticClass:"line-number"},[s._v("28")]),e("br"),e("span",{staticClass:"line-number"},[s._v("29")]),e("br"),e("span",{staticClass:"line-number"},[s._v("30")]),e("br"),e("span",{staticClass:"line-number"},[s._v("31")]),e("br"),e("span",{staticClass:"line-number"},[s._v("32")]),e("br"),e("span",{staticClass:"line-number"},[s._v("33")]),e("br"),e("span",{staticClass:"line-number"},[s._v("34")]),e("br"),e("span",{staticClass:"line-number"},[s._v("35")]),e("br"),e("span",{staticClass:"line-number"},[s._v("36")]),e("br")])]),e("h2",{attrs:{id:"相关链接"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#相关链接"}},[s._v("#")]),s._v(" 相关链接")]),s._v(" "),e("p",[e("a",{attrs:{href:"https://www.bilibili.com/video/BV13Q4y1C7hS",target:"_blank",rel:"noopener noreferrer"}},[s._v("云原生Java架构师的第一课K8s+Docker+KubeSphere+DevOps"),e("OutboundLink")],1)])])}),[],!1,null,null,null);a.default=n.exports}}]);